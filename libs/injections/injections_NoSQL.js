// Fonction de validation pour prévenir les attaques par injection NoSQL
function validateInput(input) {
    // Vérifiez que l'entrée ne contient que des caractères autorisés
    const regex = /^[a-zA-Z0-9\s\-_]+$/;
    return regex.test(input);
}

// Fonction d'échappement pour prévenir les attaques par injection NoSQL
function escapeInput(input) {
    // Utilisez une bibliothèque comme `string-similarity` pour échapper l'entrée
    // Cette bibliothèque vous permettra d'ajouter des caractères d'échappement pour les données sensibles.
    const escape = require('string-similarity').escape;

    // Échappez l'entrée
    return escape(input);
}

// Exemple d'utilisation
const userInput = req.body.username; // Vous obtenez l'entrée de l'utilisateur à partir de la demande

if (validateInput(userInput)) {
    const safeInput = escapeInput(userInput);
    // Utilisez `safeInput` dans votre application
} else {
    // Rejetez l'entrée non valide ou renvoyez une erreur
}
